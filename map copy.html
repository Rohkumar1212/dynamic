<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>India Locations - Chip UI</title>

    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css"
        integrity="sha256-p4NxAoJBhIIN+hmNHrzRCf9tD/miZyoHS5obTRR9BMY=" crossorigin="" />
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">

    <style>
        :root {
            /* Brand Colors for Chips */
            --color-all: #333;
            --color-hq: #9e9e9e;
            --color-sales: #2ecc71;
            --color-mfg: #e67e22;
            --color-training: #f1c40f;

            --bg-light: #f8f9fa;
            --surface: #ffffff;
            --transition: all 0.2s cubic-bezier(0.4, 0, 0.2, 1);
        }

        body {
            font-family: 'Inter', sans-serif;
            margin: 0;
            padding: 0;
            background-color: var(--bg-light);
            height: 100vh;
            display: flex;
            flex-direction: column;
            overflow: hidden;
        }

        .app-container {
            display: flex;
            height: 100vh;
            width: 100%;
            overflow: hidden;
        }

        /* --- 1. LEFT SIDEBAR --- */
        .sidebar {
            width: 450px;
            background: var(--surface);
            display: flex;
            flex-direction: column;
            z-index: 20;
            box-shadow: 4px 0 20px rgba(0, 0, 0, 0.05);
            flex-shrink: 0;
        }

        .sidebar-header {
            padding: 20px 24px;
            border-bottom: 1px solid #f0f0f0;
            background: #fff;
        }

        .sidebar-header h2 {
            margin: 0 0 16px 0;
            font-size: 14px;
            text-transform: uppercase;
            letter-spacing: 1.2px;
            color: #9ca3af;
            font-weight: 700;
        }

        /* --- 2. FILTER TABS (Top Chips) --- */
        .filter-tabs {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
        }

        .tab {
            display: flex;
            align-items: center;
            padding: 8px 16px;
            border-radius: 50px;
            background: #f3f4f6;
            border: 1px solid transparent;
            cursor: pointer;
            font-size: 13px;
            font-weight: 600;
            color: #4b5563;
            transition: var(--transition);
            user-select: none;
        }

        .tab:hover {
            background: #e5e7eb;
            transform: translateY(-1px);
        }

        .tab.active {
            background: #111;
            color: #fff;
            border-color: #111;
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.2);
        }

        .tab-dot {
            width: 8px;
            height: 8px;
            border-radius: 50%;
            margin-right: 8px;
            background-color: #ccc;
        }

        /* --- 3. LOCATION LIST (Chip Grid) --- */
        .location-list {
            flex: 1;
            overflow-y: auto;
            padding: 24px;
            display: flex;
            flex-wrap: wrap;
            align-content: flex-start;
            gap: 10px;
            background: #fafafa;
        }

        /* Scrollbar Styling */
        .location-list::-webkit-scrollbar {
            width: 6px;
        }

        .location-list::-webkit-scrollbar-thumb {
            background: #ddd;
            border-radius: 3px;
        }

        /* --- CHIP UI DESIGN FOR LOCATIONS --- */
        .location-card {
            display: inline-flex;
            align-items: center;
            padding: 8px 16px;
            background: #fff;
            border: 1px solid #e5e7eb;
            border-radius: 50px;
            /* Pill shape */
            cursor: pointer;
            transition: var(--transition);
            font-size: 13px;
            font-weight: 500;
            color: #374151;
            box-shadow: 0 1px 2px rgba(0, 0, 0, 0.05);
        }

        .location-card:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.08);
            border-color: #d1d5db;
        }

        .location-card.active {
            background: #111;
            color: white;
            border-color: #111;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);
        }

        .loc-dot {
            width: 8px;
            height: 8px;
            border-radius: 50%;
            margin-right: 10px;
            flex-shrink: 0;
        }

        /* White dot when active */
        .location-card.active .loc-dot {
            box-shadow: 0 0 0 2px rgba(255, 255, 255, 0.3);
        }

        /* --- 4. MAP SECTION (Right) --- */
        .map-section {
            flex: 1;
            position: relative;
            background: #fff;
            /* White background hides world loading */
        }

        #map {
            height: 100%;
            width: 100%;
            z-index: 1;
            background: #fff;
            /* Ensure map background is white */
        }

        /* Floating Count */
        .floating-stat {
            position: absolute;
            top: 20px;
            right: 20px;
            z-index: 1000;
            background: rgba(255, 255, 255, 0.9);
            backdrop-filter: blur(4px);
            padding: 8px 16px;
            border-radius: 50px;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.1);
            font-weight: 600;
            font-size: 13px;
            color: #333;
        }

        .stat-number {
            color: #2563eb;
            font-weight: 800;
            font-size: 15px;
            margin-right: 4px;
        }

        /* Custom Tooltip */
        .custom-tooltip {
            background: #1f2937;
            border: none;
            color: white;
            font-weight: 600;
            font-size: 12px;
            padding: 6px 12px;
            border-radius: 6px;
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.2);
        }

        .leaflet-tooltip-left:before,
        .leaflet-tooltip-right:before {
            border: none !important;
        }

        /* --- RESPONSIVE --- */
        @media (max-width: 768px) {
            .app-container {
                flex-direction: column;
            }

            .sidebar {
                width: 100%;
                height: 40vh;
                order: 2;
                box-shadow: 0 -4px 20px rgba(0, 0, 0, 0.1);
            }

            .map-section {
                height: 60vh;
                order: 1;
            }

            .filter-tabs {
                flex-wrap: nowrap;
                overflow-x: auto;
                padding-bottom: 5px;
            }

            .tab {
                white-space: nowrap;
            }
        }
    </style>
</head>

<body>

    <div class="app-container">
        <aside class="sidebar">
            <div class="sidebar-header">
                <h2>Locations</h2>
                <div class="filter-tabs" id="filter-container">
                    <div class="tab active" onclick="filterMap('all', this)">
                        <span class="tab-dot" style="background: var(--color-all)"></span>All
                    </div>
                    <div class="tab" onclick="filterMap('Headquarters', this)">
                        <span class="tab-dot" style="background: var(--color-hq)"></span>Headquarters
                    </div>
                    <div class="tab" onclick="filterMap('Sales', this)">
                        <span class="tab-dot" style="background: var(--color-sales)"></span>Sales
                    </div>
                    <div class="tab" onclick="filterMap('Manufacturing', this)">
                        <span class="tab-dot" style="background: var(--color-mfg)"></span>Manufacturing
                    </div>
                    <div class="tab" onclick="filterMap('Training', this)">
                        <span class="tab-dot" style="background: var(--color-training)"></span>Training
                    </div>
                </div>
            </div>

            <div class="location-list" id="location-list">
            </div>
        </aside>

        <main class="map-section">
            <div class="floating-stat">
                <span class="stat-number" id="location-count">0</span> Active Locations
            </div>
            <div id="map"></div>
        </main>
    </div>

    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"
        integrity="sha256-20nQCchB9co0qIjJZRGuk2/Z9VM+kNiyxNV1lvTlZBo=" crossorigin=""></script>

    <script>
        // --- 1. DATA CONFIGURATION ---
        // Categories & Data
        const categories = ['Headquarters', 'Sales', 'Manufacturing', 'Training'];

        // Raw Data (Shortened for example - add your full list here)
        const rawData = [
            { name: "Noida HQ", lat: 28.5355, lng: 77.3910, category: 'Headquarters' },
            { name: "Mumbai Sales", lat: 19.0760, lng: 72.8777, category: 'Sales' },
            { name: "Bangalore Dev", lat: 12.9716, lng: 77.5946, category: 'Manufacturing' },
            { name: "Delhi Office", lat: 28.7041, lng: 77.1025, category: 'Sales' },
            { name: "Hyderabad Hub", lat: 17.3850, lng: 78.4867, category: 'Training' },
            { name: "Chennai Unit", lat: 13.0827, lng: 80.2707, category: 'Manufacturing' },
            { name: "Pune Center", lat: 18.5204, lng: 73.8567, category: 'Training' },
            { name: "Kolkata Branch", lat: 22.5726, lng: 88.3639, category: 'Sales' },
            { name: "Ahmedabad", lat: 23.0225, lng: 72.5714, category: 'Sales' },
            { name: "Jaipur", lat: 26.9124, lng: 75.7873, category: 'Sales' },
        ];

        // --- 2. MAP INITIALIZATION (INDIA ONLY LOCK) ---

        // A. Define Strict Bounds (SouthWest, NorthEast)
        // These coords wrap India tightly. 
        var indiaBounds = [
            [6.0, 68.0],   // Bottom Left (Indian Ocean)
            [37.0, 97.5]   // Top Right (Himalayas/East)
        ];

        var map = L.map('map', {
            center: [22.5, 82.0], // Center of India
            zoom: 5,              // Start zoom
            minZoom: 5,           // CRITICAL: User cannot zoom out to see world
            maxBounds: indiaBounds, // CRITICAL: User cannot pan to other countries
            maxBoundsViscosity: 1.0, // Hard stop at edges
            zoomControl: false,
            attributionControl: false
        });

        // Add Zoom Control at bottom right
        L.control.zoom({ position: 'bottomright' }).addTo(map);

        // B. Add Clean Tiles (CartoDB Voyager - No clutter)
        L.tileLayer('https://{s}.basemaps.cartocdn.com/rastertiles/voyager/{z}/{x}/{y}{r}.png', {
            maxZoom: 19,
            subdomains: 'abcd'
        }).addTo(map);

        // --- 3. ICONS CONFIG ---
        function createIcon(colorName) {
            return new L.Icon({
                iconUrl: `https://raw.githubusercontent.com/pointhi/leaflet-color-markers/master/img/marker-icon-2x-${colorName}.png`,
                shadowUrl: 'https://cdnjs.cloudflare.com/ajax/libs/leaflet/0.7.7/images/marker-shadow.png',
                iconSize: [25, 41],
                iconAnchor: [12, 41],
                popupAnchor: [1, -34],
                shadowSize: [41, 41]
            });
        }

        const icons = {
            'Headquarters': createIcon('grey'),
            'Sales': createIcon('green'),
            'Manufacturing': createIcon('orange'),
            'Training': createIcon('yellow'),
            'default': createIcon('blue')
        };

        // --- 4. RENDER LOGIC (CHIP UI) ---
        let markerGroup = L.layerGroup().addTo(map);

        function renderData(dataToRender) {
            // Clear Map & List
            markerGroup.clearLayers();
            const listContainer = document.getElementById('location-list');
            listContainer.innerHTML = '';
            document.getElementById('location-count').innerText = dataToRender.length;

            if (dataToRender.length === 0) {
                listContainer.innerHTML = '<div style="width:100%; text-align:center; color:#999;">No locations found.</div>';
                return;
            }

            dataToRender.forEach(item => {
                // -- MAP MARKER --
                const icon = icons[item.category] || icons['default'];
                const marker = L.marker([item.lat, item.lng], { icon: icon });

                marker.bindTooltip(`<b>${item.name}</b><br>${item.category}`, {
                    direction: 'top',
                    className: 'custom-tooltip',
                    offset: [0, -35]
                });

                markerGroup.addLayer(marker);

                // -- LIST CHIP --
                const chip = document.createElement('div');
                chip.className = 'location-card';

                // Color logic
                let colorHex = '#333';
                if (item.category === 'Sales') colorHex = 'var(--color-sales)';
                if (item.category === 'Manufacturing') colorHex = 'var(--color-mfg)';
                if (item.category === 'Training') colorHex = 'var(--color-training)';
                if (item.category === 'Headquarters') colorHex = 'var(--color-hq)';

                chip.innerHTML = `
                    <span class="loc-dot" style="background-color: ${colorHex}"></span>
                    ${item.name}
                `;

                // INTERACTION
                const handleClick = () => {
                    // 1. Map Action
                    map.flyTo([item.lat, item.lng], 11, {
                        animate: true,
                        duration: 1.5
                    });
                    marker.openTooltip();

                    // 2. Highlight Chip
                    document.querySelectorAll('.location-card').forEach(c => c.classList.remove('active'));
                    chip.classList.add('active');

                    // 3. Mobile Scroll
                    if (window.innerWidth < 768) {
                        document.getElementById('map').scrollIntoView({ behavior: 'smooth' });
                    }
                };

                chip.onclick = handleClick;
                marker.on('click', () => {
                    handleClick();
                    chip.scrollIntoView({ behavior: "smooth", block: "center" });
                });

                listContainer.appendChild(chip);
            });
        }

        // --- 5. FILTER FUNCTION ---
        function filterMap(category, element) {
            // UI Update
            document.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
            element.classList.add('active');

            // Data Filter
            let filteredData = rawData;
            if (category !== 'all') {
                filteredData = rawData.filter(item => item.category === category);
            }

            renderData(filteredData);

            // Zoom to fit bounds of new points (Stay inside India)
            if (filteredData.length > 0) {
                const group = L.featureGroup(markerGroup.getLayers());
                map.flyToBounds(group.getBounds().pad(0.1), { maxZoom: 10 });
            }
        }

        // Initial Render
        renderData(rawData);

    </script>
</body>

</html>